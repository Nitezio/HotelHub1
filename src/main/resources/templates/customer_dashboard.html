<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="en">
<head>
    <meta charset="UTF-8"/>
    <title>My Bookings â€“ Hotel Hub 1</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Great+Vibes&display=swap" rel="stylesheet">
</head>
<body>

<nav class="navbar navbar-expand-lg">
    <div class="container-fluid">
        <a class="navbar-brand" href="#" style="color: gold; font-size: 1.5rem;">HotelHub</a>
        <div class="collapse navbar-collapse">
            <ul class="navbar-nav me-auto">
                <li class="nav-item">
                    <a class="nav-link" th:href="@{/customer/dashboard}">My Bookings</a>
                </li>
            </ul>
            <form th:action="@{/logout}" method="post" class="d-flex">
                <input type="hidden" name="_csrf" th:value="${_csrf.token}"/>
                <button class="btn btn-gold" type="submit">Logout</button>
            </form>
        </div>
    </div>
</nav>

<div class="container">
    <div class="profile-box">
        <h2>Welcome, <span th:text="${customer.name}">Customer Name</span>!</h2>
        <p><strong>Email:</strong> <span th:text="${customer.email}"></span></p>
        <p><strong>Phone:</strong> <span th:text="${customer.phoneNumber}"></span></p>
        <p><strong>Address:</strong> <span th:text="${customer.address}"></span></p>
    </div>

    <div class="title-bar d-flex justify-content-between align-items-center mb-3">
        <h2>My Bookings</h2>
        <a th:href="@{/customer/booking}" class="btn btn-gold">+ New Booking</a>
    </div>

    <section th:if="${bookings.size() > 0}">
        <table class="table table-dark table-bordered table-hover">
            <thead class="table-light text-black">
            <tr>
                <th>ID</th>
                <th>Package</th>
                <th>Room #</th>
                <th>Room Type</th>
                <th>Check-In</th>
                <th>Check-Out</th>
                <th>Status</th>
                <th>Total Price</th>
                <th>Actions</th>
            </tr>
            </thead>
            <tbody>
            <tr th:each="b : ${bookings}">
                <td th:text="${b.bookingId}">1</td>
                <td th:text="${b.aPackage.packageName}">Package</td>
                <td th:text="${b.room.roomNumber}">101</td>
                <td th:text="${b.room.roomType.typeName}">Deluxe</td>
                <td th:text="${b.checkInDate}">2025-07-01</td>
                <td th:text="${b.checkOutDate}">2025-07-05</td>
                <td th:text="${b.status}">CONFIRMED</td>
                <td th:text="${#numbers.formatDecimal(b.totalPrice, 2, 2)}">RM 200.00</td>
                <td>
                    <div class="d-flex flex-column gap-2">
                        <a th:if="${b.status != 'CANCELLED'}"
                           th:href="@{'/customer/booking/' + ${b.bookingId} + '/details'}"
                           class="btn btn-sm btn-gold">View</a>
                        <a th:if="${b.status != 'CANCELLED'}"
                           th:href="@{'/customer/booking/' + ${b.bookingId} + '/edit'}"
                           class="btn btn-sm btn-secondary">Edit</a>
                        <form th:if="${b.status != 'CANCELLED'}"
                              th:action="@{'/customer/booking/' + ${b.bookingId} + '/cancel'}"
                              method="post">
                            <input type="hidden" name="_csrf" th:value="${_csrf.token}"/>
                            <button type="submit" class="btn btn-sm btn-danger"
                                    onclick="return confirm('Are you sure you want to cancel this booking?');">Cancel</button>
                        </form>
                    </div>
                </td>
            </tr>
            </tbody>
        </table>
    </section>

    <section th:if="${bookings.size() == 0}" class="no-booking">
        <p>You have no bookings yet.</p>
        <a th:href="@{/customer/booking}" class="btn btn-gold">Make Your First Booking</a>
    </section>
</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
